<html>
	<body>
		This is the body of index3.html
		<a id="liveagent_button_online_5732C0000004CB9" 
		   href="javascript://Chat" 
		   style="display: none;"
		   onclick="liveagent.startChat('5732C0000004CB9')">
			Click to Chat
		</a>
		<div id="liveagent_button_offline_5732C0000004CB9" style="display: none;">
			Chat is not available
		</div>
		<script type="text/javascript">
			if (!window._laq) {
				window._laq = [];
			}
			window._laq.push(function(){
				liveagent.showWhenOnline('5732C0000004CB9',
							 document.getElementById('liveagent_button_online_5732C0000004CB9'));
				liveagent.showWhenOffline('5732C0000004CB9',
							  document.getElementById('liveagent_button_offline_5732C0000004CB9'));
			});
			function getFormattedTimeStamp() {
				var date = new Date();
				var year = date.getFullYear().toString();
				var month = date.getMonth() + 1 < 10 ? "0" + (date.getMonth() + 1).toString() : (date.getMonth() + 1).toString();
				var day = date.getDate() < 10 ? "0" + date.getDate().toString() : date.getDate().toString();
				var hour = date.getHours() < 10 ? "0" + date.getHours().toString() : date.getHours().toString();
				var minute = date.getMinutes() < 10 ? "0" + date.getMinutes().toString() : date.getMinutes().toString();
				var seconds = date.getSeconds() < 10 ? "0" + date.getSeconds().toString() : date.getSeconds().toString();
				var formattedDate = year + "-" + month + "-" + day + "T" + hour + ":" + minute + ":" + seconds + ".000Z";
				return formattedDate;
			}
		</script>
		<script type='text/javascript'
			src='https://c.la1-c1cs-dfw.salesforceliveagent.com/content/g/js/43.0/deployment.js'>
		</script>
		<script type='text/javascript'>
		
			var firstName = 'John';								//Must change to be dynamic
			var lastName = 'Doe';								//Must change to be dynamic
			var eid = 'R80M1221MBusiness Client';						//Must change to be dynamic
			var formattedDate = getFormattedTimeStamp();					//Returns properly formatted current timestamp
			//var token = eid + formattedDate;						//Will be dynamic once changes to EID are made
			//console.log(token);
			var name = firstName + ' ' + lastName;						//Must change to be dynamic
			var pageName = 'Unbundled Page 7';						//Must change to be dynamic
			
			liveagent.enableLogging();
			liveagent.addCustomDetail('CaseRecordType', '012610000002WztAAE', true);	//HARDCODED - Leave As Is
			liveagent.addCustomDetail('EnterpriseID', eid, true);				//Must change to be dynamic
			liveagent.addCustomDetail('ContractNumber', '617148', true);			//Must change to be dynamic		
			//liveagent.addCustomDetail('Token', token, true);				//Must change to be dynamic
			liveagent.addCustomDetail('CaseOrigin', 'Chat', true);				//HARDCODED - Leave As Is
			liveagent.addCustomDetail('CaseTopic', pageName, true);				//Must change to be dynamic
			liveagent.addCustomDetail('CaseSubject', pageName, true);			//Must change to be dynamic
			liveagent.addCustomDetail('ChatDeployment', '5722C0000004CR2', true);		//HARDCODED - Leave as is
			liveagent.addCustomDetail('ChatSubOrigin', 'Plan Sponsor', true);		//HARDCODED - Leave as is
			
			/*liveagent.findOrCreate('ChatToken__c')
				.map('Visitor_Token__c', 'Token', false, false, true)
				.map('Deployment_Key_Setting__c', 'ChatDeployment', false, false, true)
				.map('Contact__c', 'Contact', false, false, true)
				.saveToTranscript('ChatToken__c');*/
			
			liveagent.findOrCreate('Case')
				.map('RecordTypeId', 'CaseRecordType', false, false, true)
				.map('Origin', 'CaseOrigin', false, false, true)
				.map('Topic__c', 'CaseTopic', false, false, true)
				.map('Subject', 'CaseSubject', false, false, true)
				.map('Chat_Sub_Origin__c', 'ChatSubOrigin', false, false, true)
				.saveToTranscript('CaseId')
				.showOnCreate();
			
			liveagent.findOrCreate('Contract')
				.map('Contract_Source_ID__c','ContractNumber',true,true,false)
				.saveToTranscript('Chat_Contract__c')
				.linkToEntity('Case', 'Contract__c')
				.showOnCreate();
			
			liveagent.findOrCreate('Contact')
				.map('Contact_Distinct_ID__c', 'EnterpriseID', true, true, false)
				.saveToTranscript('ContactId')
				.showOnCreate()
				.linkToEntity('ChatToken__c', 'Contact__c')
				.linkToEntity('Case', 'ContactId');
			
			liveagent.setName(name);
			liveagent.setChatWindowWidth(500);
			liveagent.setChatWindowHeight(500);
			liveagent.init('https://d.la1-c1cs-dfw.salesforceliveagent.com/chat', '5722C0000004CR2', '00D2C0000000qaR');
		</script>
	</body>
</html>
